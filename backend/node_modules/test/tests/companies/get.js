var assert = require('chai').assert, should = require('chai').should(), expect = require('chai').expect,
request = require('superagent');

context('companies', function () {
  describe('Get companies', function () {
    it('should respond with status code 200 and return companies', function (done) {
      request('GET', 'http://192.168.1.221/api/companies/')
      .end(function (err, response) {
        assert.ok(response, 'response');
        response.status.should.equals(200);
        expect(response.body).to.have.length.above(0);
        for (var i = 0; i < response.body.length; i++) {
          assert.ok(response.body[i].id, 'company id');
          response.body[i].id.should.be.a('string');
          response.body[i].should.have.property('id').with.length(12);
          assert.ok(response.body[i].shortName, 'company short name');
          response.body[i].shortName.should.be.a('string');
          assert.ok(response.body[i].longName, 'company long name');
          response.body[i].longName.should.be.a('string');
          assert.ok(response.body[i].fullName, 'company full name');
          response.body[i].fullName.should.be.a('string');
        }
        done();
      });
    });
  });
  describe('Get company by id', function () {
    it('should respond with status code 200 and return company', function (done) {
      var id = 871215301100;
      request('GET', 'http://192.168.1.221/api/companies/' + id)
      .end(function (err, response) {
        assert.ok(response, 'response');
        response.status.should.equals(200);
        assert(response.body.id === '871215301100', 'invalid company id');
        assert(response.body.shortName === 'Казимпэкс', 'invalid company short name');
        assert(response.body.longName === 'АО "РЦ "Казимпэкс"', 'invalid company long name');
        assert(response.body.fullName === 'Акционерное общество "Республиканский центр "Казимпэкс"', 'invalid company full name');
        done();
      });
    });
  });
});
