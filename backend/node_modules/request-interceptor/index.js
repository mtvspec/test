'use strict';

var RequestValidator = require('request-validator');

function RequestInterceptor(request) {
  // Users
  if ((request.url === '/api/users/authentificate/' || request.url === '/api/users/authentificate') && request.method === 'POST') {
    return {result: true, message: 'ok'};
  }
  if ((request.url === '/api/users/open-session/' || request.url === '/api/users/open-session') && request.method === 'POST') {
    return {result: true, message: 'ok'};
  }
  if (((request.url === '/api/users/' || request.url === '/api/users') && request.method === 'GET')) {
    return {result: true, message: 'ok'};
  }
  // Projects
  if (((request.url === '/api/projects/' || request.url === '/api/projects') && request.method === 'GET')) {
    return {result: true, message: 'ok'};
  }
  // Dict
  if (((request.url === '/api/dict/genders/' || request.url === '/api/dict/genders') && request.method === 'GET')) {
    return {result: true, message: 'ok'};
  }
  // Persons
  if (((request.url === '/api/persons/' || request.url === '/api/persons') && request.method === 'GET')) {
    if (request.session) {
      return {result: true, message: 'ok'};
    }
  }
  if (((request.url === '/api/persons/' || request.url === '/api/persons') && request.method === 'HEAD')) {
    return {result: true, message: 'ok'};
  }
  if (request.url.startsWith('/api/persons/') && request.method === 'GET') {
    return {result: true, message: 'ok'};
  }
  if ((request.url === '/api/persons/' || request.url === '/api/persons') && request.method === 'POST') {
    return RequestValidator.validate(request.body, 'person');
  }
  if ((request.url.startsWith('/api/persons/') && request.method === 'PUT')) {
    return RequestValidator.validate(request.body, 'personData');
  }
  if ((request.url.startsWith('/api/persons/')) && request.method === 'DELETE') {
    return {result: true, message: 'ok'};
  }
  if ((request.url.startsWith('/api/persons/')) && request.method === 'OPTIONS') {
    return {result: true, message: 'ok'};
  }
  // Companies
  if (((request.url === '/api/companies/' || request.url === '/api/companies') && request.method === 'HEAD')) {
    return {result: true, message: 'ok'};
  }
  if (((request.url === '/api/companies/' || request.url === '/api/companies') && request.method === 'GET')) {
    return {result: true, message: 'ok'};
  }
  if (request.url.startsWith('/api/companies/') && request.method === 'GET') {
    return {result: true, message: 'ok'};
  }
  if ((request.url === '/api/companies/' || request.url === '/api/companies') && request.method === 'POST') {
    return RequestValidator.validate(request.body, 'company');
  }
  if ((request.url.startsWith('/api/companies/') && request.method === 'PUT')) {
    return RequestValidator.validate(request.body, 'companyData');
  }
  if ((request.url.startsWith('/api/companies/')) && request.method === 'DELETE') {
    return {result: true, message: 'ok'};
  }
  if ((request.url.startsWith('/api/companies/')) && request.method === 'OPTIONS') {
    return {result: true, message: 'ok'};
  }
  throw new Error('No request interceptor for '+request.url+' '+request.method);
};

module.exports = RequestInterceptor;
