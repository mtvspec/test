'use strict';

var Controller = require('../controller'), PGController = new Controller(),
messages = require('messages'),

RequestController = {
  validateAuthentificateRequest: function validateAuthentificateRequest(request, cb) {
    if (request.method === 'POST') {
      if (!(request.user && request.user.username && request.user.password)) {
        return cb({
          status: 400,
          message: 'User credentials not found'
        });
      }
      if (request.token) {
        return cb({
          status: 400,
          message: 'Authentificated'
        });
      }
      if (!PGController.validate({
        username: String(request.user.username),
        password: String(request.user.password)
      }, 'user')) {
        return cb({
          status: 400,
          message: 'User credentials not correct'
        });
      }
    } else {
      return cb({
        status: 404,
        message: 'Not found'
      });
    }
  }
};

module.exports = RequestController;
